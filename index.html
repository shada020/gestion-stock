<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestion Stock & Ventes</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f7f7f7; }
    h1 { text-align: center; }
    .container { max-width: 1000px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 8px; border: 1px solid #ddd; text-align: center; }
    th { background: #f0f0f0; }
    button { padding: 8px 12px; margin: 5px; cursor: pointer; }
    .btn-container { text-align: center; margin-top: 20px; }
    input, select { padding: 5px; margin: 5px; }
  </style>
</head>
<body>

  <div class="container">
    <h1>Gestion de Stock & Ventes</h1>

    <h2>Ajouter un produit</h2>
    <input type="text" id="prodName" placeholder="Nom du produit">
    <input type="number" id="prodPrice" placeholder="Prix (Fcfa)">
    <input type="number" id="prodQty" placeholder="Quantité">
    <select id="prodCategory"></select>
    <button onclick="addProduct()">Ajouter</button>

    <h2>Inventaire</h2>
    <table id="inventoryTable">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Prix (Fcfa)</th>
          <th>Quantité</th>
          <th>Catégorie</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="btn-container">
      <button onclick="exportData()">Exporter les données</button>
      <input type="file" id="importFile" style="display:none" onchange="importData(event)">
      <button onclick="document.getElementById('importFile').click()">Importer les données</button>
    </div>
  </div>

  <script>
    let stockData = JSON.parse(localStorage.getItem('stockData')) || {
      categories: ["Boissons", "Snacks"],
      products: [
        { name: "Coca-Cola", price: 600, qty: 50, category: "Boissons" },
        { name: "Fanta", price: 550, qty: 30, category: "Boissons" },
        { name: "Chips", price: 300, qty: 100, category: "Snacks" }
      ]
    };

    function saveData() {
      localStorage.setItem('stockData', JSON.stringify(stockData));
      renderInventory();
    }

    function renderInventory() {
      const tbody = document.querySelector("#inventoryTable tbody");
      tbody.innerHTML = "";
      stockData.products.forEach(p => {
        let row = `<tr>
          <td>${p.name}</td>
          <td>${p.price}</td>
          <td style="color:${p.qty <= 10 ? 'red' : 'black'}">${p.qty}</td>
          <td>${p.category}</td>
        </tr>`;
        tbody.innerHTML += row;
      });

      // Charger les catégories dans le select
      const catSelect = document.getElementById("prodCategory");
      catSelect.innerHTML = "";
      stockData.categories.forEach(cat => {
        catSelect.innerHTML += `<option value="${cat}">${cat}</option>`;
      });
    }

    function addProduct() {
      const name = document.getElementById("prodName").value.trim();
      const price = parseFloat(document.getElementById("prodPrice").value);
      const qty = parseInt(document.getElementById("prodQty").value);
      const category = document.getElementById("prodCategory").value;

      if (!name || isNaN(price) || isNaN(qty)) {
        alert("Veuillez remplir tous les champs correctement.");
        return;
      }

      stockData.products.push({ name, price, qty, category });
      saveData();
      document.getElementById("prodName").value = "";
      document.getElementById("prodPrice").value = "";
      document.getElementById("prodQty").value = "";
    }

    function exportData() {
      const blob = new Blob([JSON.stringify(stockData, null, 2)], { type: "application/json" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "stock.json";
      link.click();
    }

    function importData(event) {
      const file = event.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        stockData = JSON.parse(e.target.result);
        saveData();
      };
      reader.readAsText(file);
    }

    // Affichage initial
    renderInventory();
  </script>
</body>
</html>
